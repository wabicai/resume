(window.webpackJsonp=window.webpackJsonp||[]).push([[54],{343:function(t,e,v){"use strict";v.r(e);var a=v(10),r=Object(a.a)({},(function(){var t=this,e=t._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"_26-mutationobserver"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_26-mutationobserver"}},[t._v("#")]),t._v(" 26.MutationObserver")]),t._v(" "),e("h2",{attrs:{id:"如何监听-dom-变化"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#如何监听-dom-变化"}},[t._v("#")]),t._v(" 如何监听 DOM 变化")]),t._v(" "),e("p",[t._v("以前：")]),t._v(" "),e("ol",[e("li",[t._v("setTimeout 或者 setInterval 来定时检测 DOM 是否有改变。\n"),e("ul",[e("li",[t._v("缺点：\n"),e("ol",[e("li",[t._v("如果时间间隔设置过长，DOM 变化响应不够及时；")]),t._v(" "),e("li",[t._v("如果时间间隔设置过短，又会浪费很多无用的工作量去检查 DOM，会让页面变得低效。")])])])])])]),t._v(" "),e("p",[t._v("现在：")]),t._v(" "),e("ol",[e("li",[e("p",[t._v("2000 年引入 Mutation Event，Mutation Event 采用了观察者的设计模式，当 DOM 有变动时就会立刻触发相应的事件，这种方式属于同步回调。")]),t._v(" "),e("ol",[e("li",[t._v("但是因为每次 DOM 变动，渲染引擎都会去调用 JavaScript，这样会产生较大的性能开销。")])])]),t._v(" "),e("li",[e("p",[t._v("后来改用 MutationObserver")]),t._v(" "),e("ol",[e("li",[t._v("通过异步操作解决了同步操作的性能问题；")]),t._v(" "),e("li",[t._v("通过微任务解决了实时性的问题。（每次微任务队列执行完成，就到 UI 渲染线程）")])])])]),t._v(" "),e("h2",{attrs:{id:"mutationobserverapi-和-eventtargetapi-的-addeventlistener"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#mutationobserverapi-和-eventtargetapi-的-addeventlistener"}},[t._v("#")]),t._v(" MutationObserverAPI 和 EventTargetAPI 的 addEventListener")]),t._v(" "),e("p",[t._v("共同点: 两者的回调函数执行都是异步任务，都要在主执行栈之后执行；")]),t._v(" "),e("p",[t._v("不同点：")]),t._v(" "),e("ol",[e("li",[t._v("addEventListener 的回调函数会进入宏任务队列；")])]),t._v(" "),e("p",[t._v("MutationObserver 的回调函数会进入微任务队列")]),t._v(" "),e("ol",{attrs:{start:"2"}},[e("li",[t._v("addEventListener 的触发方式是同步触发；比如，点击后，回调函数立即进入宏任务队列。")])]),t._v(" "),e("p",[t._v("MutationObserver 的监听是异步触发，在所有的 DOM 操作完成后才触发使回调函数进入微任务队列。")]),t._v(" "),e("p",[t._v("比如，程序中有 10 个修改 DOM 的操作，只有在第十个处理完之后，回调函数才进入微任务队列。")]),t._v(" "),e("h2",{attrs:{id:"用法"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#用法"}},[t._v("#")]),t._v(" 用法")]),t._v(" "),e("ul",[e("li",[t._v("待总结")])])])}),[],!1,null,null,null);e.default=r.exports}}]);