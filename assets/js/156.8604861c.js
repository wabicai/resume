(window.webpackJsonp=window.webpackJsonp||[]).push([[156],{292:function(n,e,a){"use strict";a.r(e);var o=a(10),s=function(n){n.options.__data__block__={mermaid_1a962853:"sequenceDiagram\n    前端 ->> 业务服务器: 存在业务token，前往xxx.woa.com\n    业务服务器 --\x3e> 前端: 验证业务token登录态，登录成功\n    前端 ->>+ SSO服务器: 没有登录态，携带cookie，申请登录\n    SSO服务器 --\x3e>- 前端: 携带SSOtoken302重定向到指定页面，\n    前端->>+后端 : 登录端口，根据SSOToken生成业务token\n    后端--\x3e>-前端 : 业务token\n    前端 ->> 后端: 登录\n\n",mermaid_382ee148:"sequenceDiagram\n            用户 ->>+ xxx.woa.com : 访问\n            xxx.woa.com --\x3e>+ 智能网关 :  跳转\n            智能网关 --\x3e>- xxx.woa.com : 身份识别、签发token\n            xxx.woa.com ->>+ 用户 : token\n            用户 ->>+ xxx.woa.com : 携带token进行验证\n",mermaid_382ee14c:"sequenceDiagram\n    login->>+sop.woa.com : 跳转\n    sop.woa.com ->> sop.woa.com : ioa登录\n    sop.woa.com--\x3e>-login : sopToken\n    login->>+后端 : 根据sopToken生成业务token\n    后端--\x3e>-login : 业务token\n    login ->> tableList : 跳转首页\n    tableList ->> tableList : 获取信息时候携带token，若无权限则跳转。\n",mermaid_382ee165:"sequenceDiagram\n    participant 管理页 as 管理页/Go（cdp.qcloudtcic.com）\n    participant woa as sop.woa.com\n    autonumber\n        par 用户登录\n            rect rgb(191, 223, 255)\n                rect rgb(191, 223, 25)\n                    管理页->>+woa : 跳转\n                    woa ->> woa : ioa登录\n                    woa--\x3e>-管理页 : sopToken\n                end\n            管理页--\x3e>管理页 : 根据sopToken生成业务token\n            管理页->>+DB : 业务token解析、查询人员是否在白名单里。\n            DB--\x3e>-管理页:具有权限，登录\n        end\n    end\n        rect rgb(191, 223, 255)\n            管理页->>+DB : 业务前缀入库，如tiw\n            管理页->>+DB : 业务channelId入库，·1 方便管理页获取总列表\n            管理页->>+cdn/cos : 业务channelId添加到cos的静态文件（如tiw_xxx），表示可以开始调试\n            cdn/cos->>cdn/cos:生成cos文件、刷新cdn\n        end\n    loop 被调试端ws连接\n        rect rgb(191, 223, 255)\n            被debugger--\x3e>cdn/cos: 轮询，cos桶里是否有相应channelId\n        end\n    end\n        rect rgb(191,223,255)\n                被debugger ->> 被debugger: 有：弹窗提示“是否允许进行调试”\n                被debugger ->  wss服务: 建立websocket连接（wss-client.qcloudtcic.com）\n        end\n        rect rgb(191, 223, 255)\n            管理页->>+DB:拉取channelId染色列表\n            DB--\x3e>-管理页:channelId配置信息\n        end\n            管理页->>+debugger:携带channelId和业务token跳转调试页\n    loop 调试端ws连接\n            debugger->>+ wss服务: 请求连接ws\n        rect rgb(191, 223, 255)\n            wss服务 ->>+ 管理页: 检验业务token\n            管理页 --\x3e>-  wss服务: 合法且有权限\n            wss服务->>+管理页:检验channel是否在染色列表\n            管理页--\x3e>- wss服务:在染色列表\n        end\n            wss服务->debugger:建立websocket连接（wss-server.qcloudtcic.com）\n    end\n    par 断开连接\n        rect rgb(191, 223, 255)\n            管理页--\x3e>+ wss服务:断开ws连接\n            管理页--\x3e>+cdn/cos:删除cos桶对应文件\n        end\n    end\n",mermaid_382ee1e2:"sequenceDiagram\n    participant 管理页 as 管理页/Go（cdp.qcloudtcic.com）\n    participant woa as sop.woa.com\n    autonumber\n        par 用户登录\n            rect rgb(191, 223, 255)\n                rect rgb(191, 223, 25)\n                    管理页->>+woa : 跳转\n                    woa ->> woa : ioa登录\n                    woa--\x3e>-管理页 : sopToken\n                end\n            管理页--\x3e>管理页 : 根据sopToken生成业务token\n            管理页->>+DB : 业务token解析、查询人员是否在白名单里。\n            DB--\x3e>-管理页:具有权限，登录\n        end\n    end\n        rect rgb(191, 223, 255)\n            管理页->>+DB : channelId入库\n            管理页->>+cdn/cos : channelId加入cos的静态文件，表示可以开始调试\n            cdn/cos->>cdn/cos:生成cos文件、刷新cdn\n        end\n    loop 被调试端websocket连接\n        rect rgb(191, 223, 255)\n            被debugger--\x3e>cdn/cos: 轮询，cos桶里是否有相应channelId\n        end\n        rect rgb(191,223,255)\n                被debugger ->  wss服务: 建立websocket连接（wss-client.qcloudtcic.com）\n        end\n    end\n    管理页->>+debugger:携带channelId和业务token跳转调试页\n    loop 调试端ws连接\n            debugger->>+ wss服务: 请求连接ws\n        rect rgb(191, 223, 255)\n            wss服务 ->>+ 管理页: 检验业务token、是否在染色列表\n            管理页 --\x3e>-  wss服务: 合法且有权限\n        end\n            wss服务->debugger:建立websocket连接（wss-server.qcloudtcic.com）\n    end\n    par 断开连接\n        rect rgb(191, 223, 255)\n            管理页--\x3e>+ wss服务:断开ws连接\n            管理页--\x3e>+cdn/cos:删除cos桶对应文件\n        end\n    end\n"}},t=Object(o.a)({},(function(){var n=this,e=n._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":n.$parent.slotKey}},[e("h1",{attrs:{id:"_2-远程调试"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-远程调试"}},[n._v("#")]),n._v(" 2.远程调试")]),n._v(" "),e("h2",{attrs:{id:"登录方式"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#登录方式"}},[n._v("#")]),n._v(" 登录方式")]),n._v(" "),e("h3",{attrs:{id:"鹰眼目前的登录方式"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#鹰眼目前的登录方式"}},[n._v("#")]),n._v(" 鹰眼目前的登录方式")]),n._v(" "),e("Mermaid",{attrs:{id:"mermaid_1a962853",graph:n.$dataBlock.mermaid_1a962853}}),e("h3",{attrs:{id:"ioa-登录"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#ioa-登录"}},[n._v("#")]),n._v(" ioa 登录")]),n._v(" "),e("Mermaid",{attrs:{id:"mermaid_382ee148",graph:n.$dataBlock.mermaid_382ee148}}),e("h3",{attrs:{id:"远程调试登录逻辑"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#远程调试登录逻辑"}},[n._v("#")]),n._v(" 远程调试登录逻辑")]),n._v(" "),e("Mermaid",{attrs:{id:"mermaid_382ee14c",graph:n.$dataBlock.mermaid_382ee14c}}),e("h2",{attrs:{id:"远程调试流程图"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#远程调试流程图"}},[n._v("#")]),n._v(" 远程调试流程图")]),n._v(" "),e("Mermaid",{attrs:{id:"mermaid_382ee165",graph:n.$dataBlock.mermaid_382ee165}}),e("h4",{attrs:{id:"说明"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#说明"}},[n._v("#")]),n._v(" 说明")]),n._v(" "),e("ol",[e("li",[n._v("整个流程只在绿色部分与内网进行交互，其他地方全部部署外网。")]),n._v(" "),e("li",[n._v("wss 连接策略\n"),e("ol",[e("li",[e("s",[n._v("上下行 wss 没有进行通信 10 分钟之后自动断开两端的 wss 连接")]),n._v("。（后续考虑加入）")]),n._v(" "),e("li",[n._v("30 秒发送一次心跳，确保占用连接资格。30 秒没发送之后，如果有其他的频道连接，会被挤掉。")]),n._v(" "),e("li",[n._v("染色暂时是统一在控制页进行取消染色操作。")]),n._v(" "),e("li",[n._v("没有手动删除染色的情况下，wss 可以一直连接.")])])])]),n._v(" "),e("h3",{attrs:{id:"简化图"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#简化图"}},[n._v("#")]),n._v(" 简化图")]),n._v(" "),e("Mermaid",{attrs:{id:"mermaid_382ee1e2",graph:n.$dataBlock.mermaid_382ee1e2}})],1)}),[],!1,null,null,null);"function"==typeof s&&s(t);e.default=t.exports}}]);