(window.webpackJsonp=window.webpackJsonp||[]).push([[155],{430:function(s,a,r){"use strict";r.r(a);var t=r(14),e=Object(t.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"登录方式"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#登录方式"}},[s._v("#")]),s._v(" 登录方式")]),s._v(" "),a("h2",{attrs:{id:"鹰眼目前的登录方式"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#鹰眼目前的登录方式"}},[s._v("#")]),s._v(" 鹰眼目前的登录方式")]),s._v(" "),a("div",{staticClass:"language-mermaid line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-mermaid"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("sequenceDiagram")]),s._v(" \n    前端 "),a("span",{pre:!0,attrs:{class:"token arrow operator"}},[s._v("->>")]),s._v(" 业务服务器"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" 存在业务token，前往xxx.woa.com\n    业务服务器 "),a("span",{pre:!0,attrs:{class:"token arrow operator"}},[s._v("--\x3e>")]),s._v(" 前端"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" 验证业务token登录态，登录成功\n    前端 "),a("span",{pre:!0,attrs:{class:"token arrow operator"}},[s._v("->>")]),s._v("+ SSO服务器"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" 没有登录态，携带cookie，申请登录\n    SSO服务器 "),a("span",{pre:!0,attrs:{class:"token arrow operator"}},[s._v("--\x3e>")]),s._v("- 前端"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" 携带SSOtoken302重定向到指定页面，\n    前端"),a("span",{pre:!0,attrs:{class:"token arrow operator"}},[s._v("->>")]),s._v("+后端 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" 登录端口，根据SSOToken生成业务token\n    后端"),a("span",{pre:!0,attrs:{class:"token arrow operator"}},[s._v("--\x3e>")]),s._v("-前端 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" 业务token\n    前端 "),a("span",{pre:!0,attrs:{class:"token arrow operator"}},[s._v("->>")]),s._v(" 后端"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" 登录\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br")])]),a("h2",{attrs:{id:"ioa登录"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ioa登录"}},[s._v("#")]),s._v(" ioa登录")]),s._v(" "),a("div",{staticClass:"language-mermaid line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-mermaid"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("sequenceDiagram")]),s._v(" \n            用户 "),a("span",{pre:!0,attrs:{class:"token arrow operator"}},[s._v("->>")]),s._v("+ xxx.woa.com "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" 访问\n            xxx.woa.com "),a("span",{pre:!0,attrs:{class:"token arrow operator"}},[s._v("--\x3e>")]),s._v("+ 智能网关 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("  跳转\n            智能网关 "),a("span",{pre:!0,attrs:{class:"token arrow operator"}},[s._v("--\x3e>")]),s._v("- xxx.woa.com "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" 身份识别、签发token\n            xxx.woa.com "),a("span",{pre:!0,attrs:{class:"token arrow operator"}},[s._v("->>")]),s._v("+ 用户 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" token\n            用户 "),a("span",{pre:!0,attrs:{class:"token arrow operator"}},[s._v("->>")]),s._v("+ xxx.woa.com "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" 携带token进行验证\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("h2",{attrs:{id:"远程调试登录逻辑"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#远程调试登录逻辑"}},[s._v("#")]),s._v(" 远程调试登录逻辑")]),s._v(" "),a("div",{staticClass:"language-mermaid line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-mermaid"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("sequenceDiagram")]),s._v(" \n    login"),a("span",{pre:!0,attrs:{class:"token arrow operator"}},[s._v("->>")]),s._v("+sop.woa.com "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" 跳转\n    sop.woa.com "),a("span",{pre:!0,attrs:{class:"token arrow operator"}},[s._v("->>")]),s._v(" sop.woa.com "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" ioa登录\n    sop.woa.com"),a("span",{pre:!0,attrs:{class:"token arrow operator"}},[s._v("--\x3e>")]),s._v("-login "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" sopToken\n    login"),a("span",{pre:!0,attrs:{class:"token arrow operator"}},[s._v("->>")]),s._v("+后端 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" 根据sopToken生成业务token\n    后端"),a("span",{pre:!0,attrs:{class:"token arrow operator"}},[s._v("--\x3e>")]),s._v("-login "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" 业务token\n    login "),a("span",{pre:!0,attrs:{class:"token arrow operator"}},[s._v("->>")]),s._v(" tableList "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" 跳转首页\n    tableList "),a("span",{pre:!0,attrs:{class:"token arrow operator"}},[s._v("->>")]),s._v(" tableList "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" 获取信息时候携带token，若无权限则跳转。\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])]),a("h1",{attrs:{id:"远程调试流程图"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#远程调试流程图"}},[s._v("#")]),s._v(" 远程调试流程图")]),s._v(" "),a("h1",{attrs:{id:"调试流程图"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#调试流程图"}},[s._v("#")]),s._v(" 调试流程图")]),s._v(" "),a("div",{staticClass:"language-mermaid line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-mermaid"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("sequenceDiagram")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("participant")]),s._v(" 管理页 as 管理页/Go（cdp.qcloudtcic.com）\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("participant")]),s._v(" woa as sop.woa.com\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("autonumber")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("par")]),s._v(" 用户登录\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("rect")]),s._v(" rgb"),a("span",{pre:!0,attrs:{class:"token text string"}},[s._v("(191, 223, 255)")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("rect")]),s._v(" rgb"),a("span",{pre:!0,attrs:{class:"token text string"}},[s._v("(191, 223, 25)")]),s._v("\n                    管理页"),a("span",{pre:!0,attrs:{class:"token arrow operator"}},[s._v("->>")]),s._v("+woa "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" 跳转\n                    woa "),a("span",{pre:!0,attrs:{class:"token arrow operator"}},[s._v("->>")]),s._v(" woa "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" ioa登录\n                    woa"),a("span",{pre:!0,attrs:{class:"token arrow operator"}},[s._v("--\x3e>")]),s._v("-管理页 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" sopToken\n                "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n            管理页"),a("span",{pre:!0,attrs:{class:"token arrow operator"}},[s._v("--\x3e>")]),s._v("管理页 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" 根据sopToken生成业务token\n            管理页"),a("span",{pre:!0,attrs:{class:"token arrow operator"}},[s._v("->>")]),s._v("+DB "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" 业务token解析、查询人员是否在白名单里。\n            DB"),a("span",{pre:!0,attrs:{class:"token arrow operator"}},[s._v("--\x3e>")]),s._v("-管理页"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("具有权限，登录\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("rect")]),s._v(" rgb"),a("span",{pre:!0,attrs:{class:"token text string"}},[s._v("(191, 223, 255)")]),s._v("\n            管理页"),a("span",{pre:!0,attrs:{class:"token arrow operator"}},[s._v("->>")]),s._v("+DB "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" 业务前缀入库，如tiw\n            管理页"),a("span",{pre:!0,attrs:{class:"token arrow operator"}},[s._v("->>")]),s._v("+DB "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" 业务channelId入库，·1 方便管理页获取总列表\n            管理页"),a("span",{pre:!0,attrs:{class:"token arrow operator"}},[s._v("->>")]),s._v("+cdn/cos "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" 业务channelId添加到cos的静态文件（如tiw_xxx），表示可以开始调试\n            cdn/cos"),a("span",{pre:!0,attrs:{class:"token arrow operator"}},[s._v("->>")]),s._v("cdn/cos"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("生成cos文件、刷新cdn\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("loop")]),s._v(" 被调试端ws连接\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("rect")]),s._v(" rgb"),a("span",{pre:!0,attrs:{class:"token text string"}},[s._v("(191, 223, 255)")]),s._v("\n            被debugger"),a("span",{pre:!0,attrs:{class:"token arrow operator"}},[s._v("--\x3e>")]),s._v("cdn/cos"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" 轮询，cos桶里是否有相应channelId\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("rect")]),s._v(" rgb"),a("span",{pre:!0,attrs:{class:"token text string"}},[s._v("(191,223,255)")]),s._v("\n                被debugger "),a("span",{pre:!0,attrs:{class:"token arrow operator"}},[s._v("->>")]),s._v(" 被debugger"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" 有：弹窗提示“是否允许进行调试”\n                被debugger "),a("span",{pre:!0,attrs:{class:"token arrow operator"}},[s._v("->")]),s._v("  wss服务"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" 建立websocket连接（wss-client.qcloudtcic.com）\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("rect")]),s._v(" rgb"),a("span",{pre:!0,attrs:{class:"token text string"}},[s._v("(191, 223, 255)")]),s._v("\n            管理页"),a("span",{pre:!0,attrs:{class:"token arrow operator"}},[s._v("->>")]),s._v("+DB"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("拉取channelId染色列表\n            DB"),a("span",{pre:!0,attrs:{class:"token arrow operator"}},[s._v("--\x3e>")]),s._v("-管理页"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("channelId配置信息\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n            管理页"),a("span",{pre:!0,attrs:{class:"token arrow operator"}},[s._v("->>")]),s._v("+debugger"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("携带channelId和业务token跳转调试页\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("loop")]),s._v(" 调试端ws连接\n            debugger"),a("span",{pre:!0,attrs:{class:"token arrow operator"}},[s._v("->>")]),s._v("+ wss服务"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" 请求连接ws\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("rect")]),s._v(" rgb"),a("span",{pre:!0,attrs:{class:"token text string"}},[s._v("(191, 223, 255)")]),s._v("\n            wss服务 "),a("span",{pre:!0,attrs:{class:"token arrow operator"}},[s._v("->>")]),s._v("+ 管理页"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" 检验业务token\n            管理页 "),a("span",{pre:!0,attrs:{class:"token arrow operator"}},[s._v("--\x3e>")]),s._v("-  wss服务"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" 合法且有权限\n            wss服务"),a("span",{pre:!0,attrs:{class:"token arrow operator"}},[s._v("->>")]),s._v("+管理页"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("检验channel是否在染色列表\n            管理页"),a("span",{pre:!0,attrs:{class:"token arrow operator"}},[s._v("--\x3e>")]),s._v("- wss服务"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("在染色列表\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n            wss服务"),a("span",{pre:!0,attrs:{class:"token arrow operator"}},[s._v("->")]),s._v("debugger"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("建立websocket连接（wss-server.qcloudtcic.com）\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("par")]),s._v(" 断开连接\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("rect")]),s._v(" rgb"),a("span",{pre:!0,attrs:{class:"token text string"}},[s._v("(191, 223, 255)")]),s._v("\n            管理页"),a("span",{pre:!0,attrs:{class:"token arrow operator"}},[s._v("--\x3e>")]),s._v("+ wss服务"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("断开ws连接\n            管理页"),a("span",{pre:!0,attrs:{class:"token arrow operator"}},[s._v("--\x3e>")]),s._v("+cdn/cos"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("删除cos桶对应文件\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br"),a("span",{staticClass:"line-number"},[s._v("48")]),a("br"),a("span",{staticClass:"line-number"},[s._v("49")]),a("br"),a("span",{staticClass:"line-number"},[s._v("50")]),a("br"),a("span",{staticClass:"line-number"},[s._v("51")]),a("br"),a("span",{staticClass:"line-number"},[s._v("52")]),a("br")])]),a("h3",{attrs:{id:"说明"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#说明"}},[s._v("#")]),s._v(" 说明")]),s._v(" "),a("ol",[a("li",[s._v("整个流程只在绿色部分与内网进行交互，其他地方全部部署外网。")]),s._v(" "),a("li",[s._v("wss连接策略\n"),a("ol",[a("li",[a("s",[s._v("上下行 wss 没有进行通信 10 分钟之后自动断开两端的 wss 连接")]),s._v("。（后续考虑加入）")]),s._v(" "),a("li",[s._v("30 秒发送一次心跳，确保占用连接资格。30 秒没发送之后，如果有其他的频道连接，会被挤掉。")]),s._v(" "),a("li",[s._v("染色暂时是统一在控制页进行取消染色操作。")]),s._v(" "),a("li",[s._v("没有手动删除染色的情况下，wss 可以一直连接.")])])])]),s._v(" "),a("h2",{attrs:{id:"简化图"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#简化图"}},[s._v("#")]),s._v(" 简化图")]),s._v(" "),a("div",{staticClass:"language-mermaid line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-mermaid"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("sequenceDiagram")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("participant")]),s._v(" 管理页 as 管理页/Go（cdp.qcloudtcic.com）\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("participant")]),s._v(" woa as sop.woa.com\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("autonumber")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("par")]),s._v(" 用户登录\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("rect")]),s._v(" rgb"),a("span",{pre:!0,attrs:{class:"token text string"}},[s._v("(191, 223, 255)")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("rect")]),s._v(" rgb"),a("span",{pre:!0,attrs:{class:"token text string"}},[s._v("(191, 223, 25)")]),s._v("\n                    管理页"),a("span",{pre:!0,attrs:{class:"token arrow operator"}},[s._v("->>")]),s._v("+woa "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" 跳转\n                    woa "),a("span",{pre:!0,attrs:{class:"token arrow operator"}},[s._v("->>")]),s._v(" woa "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" ioa登录\n                    woa"),a("span",{pre:!0,attrs:{class:"token arrow operator"}},[s._v("--\x3e>")]),s._v("-管理页 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" sopToken\n                "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n            管理页"),a("span",{pre:!0,attrs:{class:"token arrow operator"}},[s._v("--\x3e>")]),s._v("管理页 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" 根据sopToken生成业务token\n            管理页"),a("span",{pre:!0,attrs:{class:"token arrow operator"}},[s._v("->>")]),s._v("+DB "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" 业务token解析、查询人员是否在白名单里。\n            DB"),a("span",{pre:!0,attrs:{class:"token arrow operator"}},[s._v("--\x3e>")]),s._v("-管理页"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("具有权限，登录\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("rect")]),s._v(" rgb"),a("span",{pre:!0,attrs:{class:"token text string"}},[s._v("(191, 223, 255)")]),s._v("\n            管理页"),a("span",{pre:!0,attrs:{class:"token arrow operator"}},[s._v("->>")]),s._v("+DB "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" channelId入库\n            管理页"),a("span",{pre:!0,attrs:{class:"token arrow operator"}},[s._v("->>")]),s._v("+cdn/cos "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" channelId加入cos的静态文件，表示可以开始调试\n            cdn/cos"),a("span",{pre:!0,attrs:{class:"token arrow operator"}},[s._v("->>")]),s._v("cdn/cos"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("生成cos文件、刷新cdn\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("loop")]),s._v(" 被调试端websocket连接\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("rect")]),s._v(" rgb"),a("span",{pre:!0,attrs:{class:"token text string"}},[s._v("(191, 223, 255)")]),s._v("\n            被debugger"),a("span",{pre:!0,attrs:{class:"token arrow operator"}},[s._v("--\x3e>")]),s._v("cdn/cos"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" 轮询，cos桶里是否有相应channelId\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("rect")]),s._v(" rgb"),a("span",{pre:!0,attrs:{class:"token text string"}},[s._v("(191,223,255)")]),s._v("\n                被debugger "),a("span",{pre:!0,attrs:{class:"token arrow operator"}},[s._v("->")]),s._v("  wss服务"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" 建立websocket连接（wss-client.qcloudtcic.com）\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n    管理页"),a("span",{pre:!0,attrs:{class:"token arrow operator"}},[s._v("->>")]),s._v("+debugger"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("携带channelId和业务token跳转调试页\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("loop")]),s._v(" 调试端ws连接\n            debugger"),a("span",{pre:!0,attrs:{class:"token arrow operator"}},[s._v("->>")]),s._v("+ wss服务"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" 请求连接ws\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("rect")]),s._v(" rgb"),a("span",{pre:!0,attrs:{class:"token text string"}},[s._v("(191, 223, 255)")]),s._v("\n            wss服务 "),a("span",{pre:!0,attrs:{class:"token arrow operator"}},[s._v("->>")]),s._v("+ 管理页"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" 检验业务token、是否在染色列表\n            管理页 "),a("span",{pre:!0,attrs:{class:"token arrow operator"}},[s._v("--\x3e>")]),s._v("-  wss服务"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" 合法且有权限\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n            wss服务"),a("span",{pre:!0,attrs:{class:"token arrow operator"}},[s._v("->")]),s._v("debugger"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("建立websocket连接（wss-server.qcloudtcic.com）\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("par")]),s._v(" 断开连接\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("rect")]),s._v(" rgb"),a("span",{pre:!0,attrs:{class:"token text string"}},[s._v("(191, 223, 255)")]),s._v("\n            管理页"),a("span",{pre:!0,attrs:{class:"token arrow operator"}},[s._v("--\x3e>")]),s._v("+ wss服务"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("断开ws连接\n            管理页"),a("span",{pre:!0,attrs:{class:"token arrow operator"}},[s._v("--\x3e>")]),s._v("+cdn/cos"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("删除cos桶对应文件\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br")])])])}),[],!1,null,null,null);a.default=e.exports}}]);